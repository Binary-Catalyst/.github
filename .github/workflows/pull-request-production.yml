# This is a basic workflow to help you get started with Actions

name: Production - 1. Auto-merge Pull Request

# Controls when the action will run.
on:
  # Triggers the workflow on push or pull request events but only for the staging branch
  pull_request_target:
    types: [assigned, opened, synchronize, reopened, ready_for_review]
  workflow_dispatch:
    inputs:
      pull-request:
        description: Pull Request Number
        required: false

  # Allows you to run this workflow manually from the Actions tab
  # workflow_dispatch:

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  automerge:
    if: github.event.review.state == 'approved' || !github.event.review
    runs-on: ubuntu-latest
    steps:
      - uses: reitermarkus/automerge@v1
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          merge-method: squash
          do-not-merge-labels: never-merge
          pull-request: ${{ github.event.inputs.pull-request }}
          dry-run: false
